<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eberardos API Tester | Crimson Hub</title>
    <style>
        /* BASE & THEME */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            padding: 20px;
            background-color: #1a1a1a; /* Dark Background */
            color: #f0f0f0; /* Light Text */
            transition: background-color 0.3s;
        }
        .container { 
            max-width: 900px; 
            margin: 40px auto; 
            background: #242424; /* Slightly Lighter Dark BG */
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5); /* Stronger Shadow */
            border-top: 3px solid #a52a2a; /* Crimson Accent Line */
        }
        h1 { 
            color: #a52a2a; /* Crimson Main Title */
            text-align: center; 
            margin-bottom: 25px; 
            font-weight: 700;
        }
        p code {
            background-color: #333;
            padding: 3px 6px;
            border-radius: 4px;
            color: #ccc;
        }
        hr { border-color: #333; margin: 20px 0; }

        /* INPUT GROUPS & FORMS */
        .input-group { 
            margin-bottom: 25px; 
            padding: 20px; 
            border: 1px solid #333; 
            border-radius: 8px; 
            background-color: #2c2c2c; 
        }
        label { 
            display: block; 
            margin-bottom: 8px; 
            font-weight: 600; 
            color: #ccc; 
        }
        input[type="text"], input[type="number"], select { 
            width: 100%; 
            padding: 12px; 
            margin-top: 5px; 
            margin-bottom: 10px;
            border: 1px solid #444; 
            border-radius: 6px; 
            box-sizing: border-box; 
            background-color: #3c3c3c; /* Dark Input BG */
            color: #f0f0f0;
            transition: border-color 0.3s;
        }
        input:focus, select:focus {
            border-color: #a52a2a; /* Crimson focus */
            outline: none;
        }

        /* BUTTONS */
        button { 
            background-color: #a52a2a; /* Crimson */
            color: white; 
            padding: 12px 20px; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 16px; 
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.1s; 
        }
        button:hover { 
            background-color: #8b1a1a; /* Darker Crimson */
            transform: translateY(-1px);
        }

        /* RESPONSE AREA */
        .response-section { margin-top: 35px; }
        h2 { color: #ccc; margin-bottom: 15px; font-weight: 500;}

        textarea { 
            width: 100%; 
            height: 400px; 
            padding: 20px; 
            border: 1px solid #444; 
            border-radius: 8px; 
            font-family: Consolas, monospace; 
            font-size: 14px; 
            background-color: #111; /* Very Dark Code Area */
            color: #4CAF50; /* Green text for code contrast */
            resize: vertical; 
        }
        
        /* STATUS BAR */
        .status-bar { padding: 12px; margin-bottom: 15px; border-radius: 6px; font-weight: bold; }
        .status-ok { background-color: #4CAF50; color: #fff; } /* Green */
        .status-error { background-color: #f44336; color: #fff; } /* Red */
        .status-info { background-color: #2196F3; color: #fff; } /* Blue */

        #copyButton { 
            background-color: #4CAF50; /* Green for Copy */
            margin-top: 15px; 
        }
        #copyButton:hover { 
            background-color: #388e3c; 
        }
    </style>
</head>
<body>

<div class="container">
    <h1>‚öîÔ∏è Eberardos API Tester <small style="font-size: 14px; color: #999;">(Crimson Matrix)</small></h1>
    <p>Base URL: <code>https://api.eberardos.my.id/api/rucoy</code></p>
    <hr>

    <div class="input-group">
        <label for="endpoint">Pilih Endpoint:</label>
        <select id="endpoint" onchange="toggleInputs()">
            <option value="stalk">1. Rucoy Stalk Karakter</option>
            <option value="leaderboard">2. Rucoy Leaderboard</option>
        </select>
    </div>

    <div id="stalk-inputs" class="input-group">
        <label for="charName">Nama Karakter (Wajib):</label>
        <input type="text" id="charName" placeholder="Contoh: Velica Corrupt">
        <button onclick="executeStalk()">‚ö°Ô∏è Execute Stalk</button>
    </div>

    <div id="leaderboard-inputs" class="input-group" style="display: none;">
        <label for="category">Kategori (Default: Experience):</label>
        <select id="category">
            <option value="experience">Experience</option>
            <option value="melee">Melee</option>
            <option value="distance">Distance</option>
            <option value="magic">Magic</option>
            <option value="defense">Defense</option>
        </select>
        <label for="limit">Limit (Jumlah Data - Max 500, Default 100):</label>
        <input type="number" id="limit" value="100" min="1" max="500">
        <button onclick="executeLeaderboard()">‚ö°Ô∏è Execute Leaderboard</button>
    </div>

    <div class="response-section">
        <h2>JSON Response:</h2>
        <div id="statusBar" class="status-bar status-info">Status: Siap diuji.</div>
        <textarea id="responseTextarea" readonly placeholder="Hasil JSON akan muncul di sini..."></textarea>
        <button id="copyButton" onclick="copyResponse()">üìã Salin Response</button>
    </div>
</div>

<script>
    const BASE_URL = 'https://api.eberardos.my.id/api/rucoy';
    const responseTextarea = document.getElementById('responseTextarea');
    const statusBar = document.getElementById('statusBar');

    // INITIAL SETUP
    window.onload = toggleInputs; 
    
    function toggleInputs() {
        const endpoint = document.getElementById('endpoint').value;
        document.getElementById('stalk-inputs').style.display = endpoint === 'stalk' ? 'block' : 'none';
        document.getElementById('leaderboard-inputs').style.display = endpoint === 'leaderboard' ? 'block' : 'none';
        
        responseTextarea.value = '';
        statusBar.className = 'status-bar status-info';
        statusBar.textContent = 'Status: Pilih endpoint yang ingin diuji.';
    }

    async function fetchData(url) {
        statusBar.className = 'status-bar status-info';
        statusBar.textContent = `Status: Mengirim permintaan ke ${url}...`;
        responseTextarea.value = 'Loading...';

        try {
            const response = await fetch(url);
            const data = await response.json();
            
            const formattedJson = JSON.stringify(data, null, 4); 
            responseTextarea.value = formattedJson;

            // Update Status Bar berdasarkan respons HTTP
            if (response.ok) {
                statusBar.className = 'status-bar status-ok';
                statusBar.textContent = `Status: Sukses (${response.status} OK)`;
            } else {
                statusBar.className = 'status-bar status-error';
                statusBar.textContent = `Status: Gagal (${response.status} ${data.error || 'Server Error'})`;
            }

        } catch (error) {
            console.error('Fetch Error:', error);
            statusBar.className = 'status-bar status-error';
            statusBar.textContent = `Status: Kesalahan Jaringan. Pastikan server aktif.`;
            responseTextarea.value = `ERROR: Gagal menghubungi API. ${error.message}`;
        }
    }

    function executeStalk() {
        const charName = document.getElementById('charName').value.trim();
        if (!charName) {
            alert('Harap masukkan Nama Karakter!');
            return;
        }
        
        const encodedName = encodeURIComponent(charName);
        const url = `${BASE_URL}/stalk?name=${encodedName}`;
        fetchData(url);
    }

    function executeLeaderboard() {
        const category = document.getElementById('category').value;
        const limit = document.getElementById('limit').value;

        if (limit < 1 || limit > 500) {
            alert('Limit harus antara 1 sampai 500!');
            return;
        }
        
        const url = `${BASE_URL}/leaderboard?category=${category}&limit=${limit}`;
        fetchData(url);
    }

    function copyResponse() {
        responseTextarea.select();
        // Fallback for older browsers
        try {
            document.execCommand('copy');
            alert('Response JSON berhasil disalin!');
        } catch (err) {
            navigator.clipboard.writeText(responseTextarea.value);
            alert('Response JSON berhasil disalin (via Clipboard API)!');
        }
    }
</script>

</body>
</html>
